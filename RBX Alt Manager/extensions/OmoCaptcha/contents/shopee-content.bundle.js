(()=>{"use strict";const e={API_KEY:{key:"api_key",defaultValue:""},APP_ID:{key:"appId",defaultValue:""},POWER_ON:{key:"power_on",defaultValue:!0},TIKTOK:{key:"tiktok",defaultValue:{delayClick:500,delaySwipe:15,loop:!0,isActive:!0}},FUNCAPTCHA:{key:"funcaptcha",defaultValue:{delayClick:100,loop:!0,isActive:!0,maxImageCaptcha:25}},ZALO:{key:"zalo",defaultValue:{delayClick:100,loop:!0,isActive:!0}},SHOPEE:{key:"shopee",defaultValue:{delaySwipe:15,loop:!0,isActive:!0}},RECAPTCHAV2:{key:"reCaptchav2",defaultValue:{delayClick:500,loop:!0,isActive:!0,useToken:!1}},AMZN:{key:"amzn",defaultValue:{delayClick:100,loop:!0,isActive:!0}},GEETEST:{key:"geetest",defaultValue:{delayClick:500,delaySwipe:15,loop:!0,isActive:!0}},SLIDE_ALL:{key:"slide_all",defaultValue:{delaySwipe:15,loop:!0,isActive:!0}},HCAPTCHA:{key:"hcaptcha",defaultValue:{delayClick:500,delaySwipe:15,loop:!0,isActive:!0}},CLOUDFLARE:{key:"cloudflare",defaultValue:{delayClick:2e3,isActive:!0}},TENCENT:{key:"tencent",defaultValue:{delayClick:500,delaySwipe:15,loop:!0,isActive:!0}}};async function t(e,t,a){const n="undefined"!=typeof browser?browser.runtime:chrome.runtime;try{return await new Promise(((i,r)=>{n.sendMessage({source:e,type:t,data:a},(e=>{n.lastError?r(new Error(`Error sending message: ${n.lastError.message}`)):i(e)}))}))}catch(e){throw e}}const a=async(e,t)=>{const a="undefined"!=typeof browser?browser.storage.local:chrome.storage.local,n="undefined"!=typeof browser?browser.runtime:chrome.runtime;try{const i=await a.get([e]);if(n.lastError)throw new Error(`Error retrieving ${e}: ${n.lastError.message}`);return null!=i[e]?i[e]:t}catch(e){throw e}};Promise.resolve();async function n(e){return new Promise((t=>setTimeout(t,e)))}function i(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"success",a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;const n="1.5.6";let i=document.getElementById("captcha-message");i||(i=document.createElement("div"),i.id="captcha-message",i.style.zIndex="99999999",i.style.padding="3px 3px",i.style.borderRadius="3px",i.style.boxShadow="0 2px 10px rgba(0, 0, 0, 0.2)",i.style.fontSize="10px",i.style.fontWeight="600",i.style.fontFamily="Arial, sans-serif",i.style.textAlign="center",i.style.whiteSpace="nowrap",i.style.color="white",i.style.top="1px",a&&a.parentElement?(i.style.position="absolute",i.style.left="2px",a.parentElement.appendChild(i)):(i.style.position="fixed",i.style.left="1px",document.body.appendChild(i)));const r={success:"linear-gradient(90deg, #6a11cb,rgb(191, 37, 252))",error:"linear-gradient(90deg, #ff416c, #ff4b2b)",warning:"linear-gradient(90deg, #ff9a44, #fc6076)",info:"linear-gradient(90deg, #17a2b8, #138496)"};i.innerText=`[OMOcaptcha-${n}] `+e,i.style.background=r[t]||r.success,i.style.display="block"}function r(){const e=document.getElementById("captcha-message");e&&e.remove()}async function o(e){try{const a=await t("SOURCE","createTask",e);return a||""}catch(e){return""}}async function c(e,a,n){const i=JSON.stringify({clientKey:e,taskId:a});try{const e=await t("SOURCE","getTaskResult",{data:i,timeWait:n});return e?"fail"===e.status?{errorDescription:e.errorDescription}:e.solution?e.solution:e.type?e:null:null}catch(e){return null}}let s,d,l,u,p;let f=!1,y=[];async function h(){var e="";let t=document.querySelector('[role="dialog"] [id*="captchaMask"]');i("Captcha slide","red",t);for(var a=0;a<30;a++){i("Get image...","red",t),a>0&&await n(1e3);var r=document.querySelector('[role="dialog"] [id*="captchaMask"] div > div:nth-of-type(1) > img');if(r&&e!==r.src){e=r.src;var s=document.querySelector('[role="dialog"] [id*="captchaMask"] div > div:nth-of-type(2) > img');i("Create task...","red",t);const a=JSON.stringify({clientKey:d,task:{type:"ShopeeSliderWebTask",typeCaptcha:"",imageBase64s:[s.src,e]}}),n=await o(a);let l="";if(!n||n.error||n.message){if(l=n.error?n.errorDescription:n.message?n.message:"No response createTask",i(l,"red",t),u){await w(s,1);continue}return}{i("Get result...","red",t);const a=await c(d,n.taskId,30);if(!a||a.errorDescription){e="";if(i(a?a.errorDescription:"No result from API","red",t),u){await w(s,1);continue}return}let r=parseInt(a.end.x,10);if(i("Solving...","red",t),await w(s,r),!u)return}}}}async function m(){var e="";let t=document.querySelector('[id*="captchaMask"]');i("Captcha slide new","red",t);for(var a=0;a<35;a++){i("Get image...","red",t),await n(600+800*Math.random());const a=document.querySelector('[id*="captchaMask"] div > div:nth-of-type(1) > img'),s=document.querySelector('[id*="sliderContainer"]'),l=document.querySelector('[id*="captchaMask"] div > div:nth-of-type(2) > img');if(a&&s&&l&&e!==a.src){e=a.src,i("Create task...","red",t);const p=JSON.stringify({clientKey:d,task:{type:"ShopeeSliderWebTask",typeCaptcha:"rotate",imageBase64s:[l.src,e]}}),f=await o(p);let h="";if(!f||f.error||f.message){if(h=f.error?f.errorDescription:f.message?f.message:"No response createTask",i(h,"red",t),await n(2e3),u)continue;return}y.push(f.taskId),i("Get result...","red",t);const m=await c(d,f.taskId,30);if(!m||m.errorDescription){e="";const a=m?m.errorDescription:"No result from API";if(await n(300),i(a,"red",t),u){await w(l,3),await n(2e3);continue}return}if(!m.point||!m.point.x||!m.point.y){if(u){await w(l,3),await n(2e3);continue}return}let g=parseFloat(m.point.x),v=parseFloat(m.point.y);const E=a.getBoundingClientRect(),b=E.width/a.naturalWidth,C=E.height/a.naturalHeight,A=E.left+g*b,S=E.top+v*C;if(i("Solving...","red",t),await k(s,l,A,S),await n(3e3),!document.querySelector('[id*="captchaMask"]'))return void r();if(location.href.includes("/verify/captcha?anti_bot_tracking_id")&&await M(!1),!u)return}}}function g(e){return!!document.querySelector(e)}async function v(e,t){const a=Date.now()+t;for(;Date.now()<a;){for(const t of e){if(document.querySelector(t))return!0}await n(500)}return!1}function w(e,t){return new Promise(((a,n)=>{if(!e)return void n("Element not found");function i(){const t=e.getBoundingClientRect();return{centerX:t.left+t.width/2,centerY:t.top+t.height/2}}const r=new DataTransfer;function o(t,a,n){const i={bubbles:!0,cancelable:!0,clientX:a,clientY:n,dataTransfer:r,...arguments.length>3&&void 0!==arguments[3]?arguments[3]:{}},o=t.includes("drag")?new DragEvent(t,i):new MouseEvent(t,i);e.dispatchEvent(o)}const c=i(),s=c.centerX+t;o("pointerenter",c.centerX,c.centerY),o("mouseover",c.centerX,c.centerY),o("mousedown",c.centerX,c.centerY),o("dragstart",c.centerX,c.centerY);let d=c.centerX,l=10,u=3;!function e(){const n=i();if(Math.abs(n.centerX-s)<=1)return void setTimeout((()=>{o("dragend",n.centerX,n.centerY),o("mouseup",n.centerX,n.centerY),a()}),1e3);s-n.centerX>t/4?(l=10,u=3):(l=1,u=10),d+=l*Math.sign(s-n.centerX);const r=n.centerY;o("mousemove",d,r),o("drag",d,r),setTimeout(e,u)}()}))}async function k(e,t,a,n){if(!e||!t)return;function i(e){const t=e.getBoundingClientRect();return{x:t.left+t.width/2,y:t.top+t.height/2}}const r=e=>new Promise((t=>setTimeout(t,e))),o=new DataTransfer;function c(t,a,n){const i=t.includes("drag")?new DragEvent(t,{bubbles:!0,cancelable:!0,clientX:a,clientY:n,dataTransfer:o}):new MouseEvent(t,{bubbles:!0,cancelable:!0,clientX:a,clientY:n});e.dispatchEvent(i)}{const t=e.getBoundingClientRect(),a=t.left+t.width*(.3+.4*Math.random()),n=t.top+t.height*(.3+.4*Math.random());e.dispatchEvent(new MouseEvent("pointerenter",{bubbles:!0,clientX:a,clientY:n})),e.dispatchEvent(new MouseEvent("mouseover",{bubbles:!0,clientX:a,clientY:n})),e.dispatchEvent(new MouseEvent("mousemove",{bubbles:!0,clientX:a+4*(Math.random()-.5),clientY:n+4*(Math.random()-.5)})),await r(90+90*Math.random())}const s=i(e);c("pointerenter",s.x,s.y),c("mouseover",s.x,s.y),await r(50+150*Math.random()),c("mousedown",s.x,s.y),c("dragstart",s.x,s.y);let d=s.x,l=s.y,u=1,p=0;let f=5;for(;;){const e=i(t),o=a-e.x,s=n-e.y,y=Math.sqrt(o*o+s*s);if(f<=15&&p>=35&&p%2==0&&(f+=.3),1===u&&y<f){const e=30;d+=o/y*e,l+=s/y*e,c("mousemove",d,l),c("drag",d,l),u=2,f=0,await r(10+20*Math.random());continue}if(2===u){const e=-10;d+=o/y*e,l+=s/y*e,c("mousemove",d,l),c("drag",d,l),u=3,await r(10+20*Math.random());continue}if(3===u&&y<f){d+=o,l+=s,c("mousemove",d,l),c("drag",d,l);break}let h;h=y>50?6+1.5*Math.random():y>20?3+Math.random():1.5+.5*Math.random();const m=.5+Math.random(),g=Math.sin(p/200*Math.PI)*m*5;if(d+=o/y*h+.5*(Math.random()-.5),l+=s/y*h+g+.5*(Math.random()-.5),c("mousemove",d,l),c("drag",d,l),p%10==0&&Math.random()<1){c("mousemove",d+4*(Math.random()-.5),l+4*(Math.random()-.5)),await r(10+30*Math.random())}let v;if(v=y>50?5+10*Math.random():y>20?5+20*Math.random():10+20*Math.random(),await r(v),p++,p>200)break}await r(70+100*Math.random()),c("dragend",d,l),c("mouseup",d,l)}async function M(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(0===y.length)return;const a={taskIds:y,result:e};try{await t("SHOPEE","reportTask",a)}catch(e){}finally{y=[]}}new MutationObserver((async(e,t)=>{await async function(e){if(s&&p&&d&&"YOUR_CLIEN_KEY"!==d)for(const t of e)if("childList"===t.type){const e=document.querySelector('[role="dialog"] [id*="captchaMask"]'),t=document.querySelector('[data-cy*="generic_popup_content"] [id*="captchaMask"]'),a=document.querySelector('[id*="NEW_CAPTCHA"] [id*="captchaMask"]');if(e||t||a){if(!f){if(!d)return;f=!0,await n(1e3),v(['[role="dialog"] [id*="captchaMask"] div > div:nth-of-type(1) > img','[role="dialog"] [id*="captchaMask"] div > div:nth-of-type(2) > img','[data-cy*="generic_popup_content"] [id*="captchaMask"] div > div:nth-of-type(1) > img','[data-cy*="generic_popup_content"] [id*="captchaMask"] div > div:nth-of-type(2) > img','[id*="NEW_CAPTCHA"] [id*="captchaMask"] div > div:nth-of-type(1) > img','[id*="NEW_CAPTCHA"] [id*="captchaMask"] div > div:nth-of-type(2) > img'],1e4).then((async e=>{if(e)for(var t=0;t<20;t++){if(g('[data-cy*="generic_popup_content"] [id*="captchaMask"] div > div:nth-of-type(1) > img')&&g('[data-cy*="generic_popup_content"] [id*="captchaMask"] div > div:nth-of-type(2) > img')){await m();break}if(g('[id*="NEW_CAPTCHA"] [id*="captchaMask"] div > div:nth-of-type(1) > img')&&g('[id*="NEW_CAPTCHA"] [id*="captchaMask"] div > div:nth-of-type(2) > img')){await m();break}if(g('[role="dialog"] [id*="captchaMask"] div > div:nth-of-type(1) > img')&&g('[role="dialog"] [id*="captchaMask"] div > div:nth-of-type(2) > img')){await h();break}await n(500)}}))}}else f=!1}}(e)})).observe(document.body,{childList:!0,subtree:!0}),(async()=>{await async function(){s=await a(e.POWER_ON.key,e.POWER_ON.defaultValue),d=await a(e.API_KEY.key,e.API_KEY.defaultValue);const t=await a(e.SHOPEE.key,e.SHOPEE.defaultValue);l=t.delaySwipe,u=t.loop,p=t.isActive}()})()})();