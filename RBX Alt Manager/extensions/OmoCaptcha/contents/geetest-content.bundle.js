(()=>{"use strict";const e={API_KEY:{key:"api_key",defaultValue:""},APP_ID:{key:"appId",defaultValue:""},POWER_ON:{key:"power_on",defaultValue:!0},TIKTOK:{key:"tiktok",defaultValue:{delayClick:500,delaySwipe:15,loop:!0,isActive:!0}},FUNCAPTCHA:{key:"funcaptcha",defaultValue:{delayClick:100,loop:!0,isActive:!0,maxImageCaptcha:25}},ZALO:{key:"zalo",defaultValue:{delayClick:100,loop:!0,isActive:!0}},SHOPEE:{key:"shopee",defaultValue:{delaySwipe:15,loop:!0,isActive:!0}},RECAPTCHAV2:{key:"reCaptchav2",defaultValue:{delayClick:500,loop:!0,isActive:!0,useToken:!1}},AMZN:{key:"amzn",defaultValue:{delayClick:100,loop:!0,isActive:!0}},GEETEST:{key:"geetest",defaultValue:{delayClick:500,delaySwipe:15,loop:!0,isActive:!0}},SLIDE_ALL:{key:"slide_all",defaultValue:{delaySwipe:15,loop:!0,isActive:!0}},HCAPTCHA:{key:"hcaptcha",defaultValue:{delayClick:500,delaySwipe:15,loop:!0,isActive:!0}},CLOUDFLARE:{key:"cloudflare",defaultValue:{delayClick:2e3,isActive:!0}},TENCENT:{key:"tencent",defaultValue:{delayClick:500,delaySwipe:15,loop:!0,isActive:!0}}},t=async(e,t)=>{const s="undefined"!=typeof browser?browser.storage.local:chrome.storage.local,a="undefined"!=typeof browser?browser.runtime:chrome.runtime;try{const l=await s.get([e]);if(a.lastError)throw new Error(`Error retrieving ${e}: ${a.lastError.message}`);return null!=l[e]?l[e]:t}catch(e){throw e}};Promise.resolve();async function s(e,t,s){const a="undefined"!=typeof browser?browser.runtime:chrome.runtime;try{return await new Promise(((l,r)=>{a.sendMessage({source:e,type:t,data:s},(e=>{a.lastError?r(new Error(`Error sending message: ${a.lastError.message}`)):l(e)}))}))}catch(e){throw e}}async function a(e){return new Promise((t=>setTimeout(t,e)))}function l(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"success",s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;const a="1.5.6";let l=document.getElementById("captcha-message");l||(l=document.createElement("div"),l.id="captcha-message",l.style.zIndex="99999999",l.style.padding="3px 3px",l.style.borderRadius="3px",l.style.boxShadow="0 2px 10px rgba(0, 0, 0, 0.2)",l.style.fontSize="10px",l.style.fontWeight="600",l.style.fontFamily="Arial, sans-serif",l.style.textAlign="center",l.style.whiteSpace="nowrap",l.style.color="white",l.style.top="1px",s&&s.parentElement?(l.style.position="absolute",l.style.left="2px",s.parentElement.appendChild(l)):(l.style.position="fixed",l.style.left="1px",document.body.appendChild(l)));const r={success:"linear-gradient(90deg, #6a11cb,rgb(191, 37, 252))",error:"linear-gradient(90deg, #ff416c, #ff4b2b)",warning:"linear-gradient(90deg, #ff9a44, #fc6076)",info:"linear-gradient(90deg, #17a2b8, #138496)"};l.innerText=`[OMOcaptcha-${a}] `+e,l.style.background=r[t]||r.success,l.style.display="block"}function r(e,t){return new Promise((s=>{const a=Date.now(),l=setInterval((()=>{for(const t of e){if(document.querySelector(t))return clearInterval(l),void s(!0)}Date.now()-a>=t&&(clearInterval(l),s(!1))}),500)}))}function c(e){["pointerdown","mousedown","mouseup","click"].forEach((function(t){e.dispatchEvent(new MouseEvent(t,{bubbles:!0,cancelable:!0,view:window}))}))}async function o(e){try{const t=await s("SOURCE","createTask",e);return t||""}catch(e){return""}}async function i(e,t,a){const l=JSON.stringify({clientKey:e,taskId:t});try{const e=await s("SOURCE","getTaskResult",{data:l,timeWait:a});return e?"fail"===e.status?{errorDescription:e.errorDescription}:e.solution?e.solution:e.type?e:null:null}catch(e){return null}}async function n(e){try{if(e instanceof Element&&e.src&&(e=e.src),"string"!=typeof e||!e.startsWith("http"))return"";const t=await new Promise((t=>{chrome.runtime.sendMessage({type:"createImageBase64",data:{url:e}},(e=>{if(chrome.runtime.lastError)return t("");t(e||"")}))}));return t||""}catch(e){return""}}async function u(e){for(let t=0;t<5;t++){const t=getComputedStyle(e),s=t.backgroundImage.match(/url\(["']?(.*?)["']?\)/)?.[1];if(s&&"none"!==s){const e=new URL(s,window.location.href).href;return await n(e)}await a(500)}return""}async function g(e,t){return new Promise((async s=>{const a=new Image;a.src="data:image/jpeg;base64,"+e,await a.decode();const l=t.getBoundingClientRect(),r=l.width,c=l.height,o=document.createElement("canvas");o.width=r,o.height=c;o.getContext("2d").drawImage(a,0,0,r,c);s(o.toDataURL("image/jpeg").split(",")[1])}))}let d,y,f,b,p,_;async function m(){d=await t(e.POWER_ON.key,e.POWER_ON.defaultValue),y=await t(e.API_KEY.key,e.API_KEY.defaultValue);const s=await t(e.GEETEST.key,e.GEETEST.defaultValue);f=s.delayClick,b=s.delaySwipe,p=s.loop,_=s.isActive}let w=!1,k="";async function h(){for(;;){await a(700);let e=null;for(let t=0;t<10&&(t>0&&await a(1e3),e=document.querySelector('[class*="geetest_box"][style="display: block;"] [class*="geetest_container"] [class*="geetest_winlinze"]'),null==e);t++);if(!e)return;let t=document.querySelector('[class*="geetest_box"][style*="display: block;"] [class*="geetest_header"] [class*="geetest_title"]');l("Captcha Gobang","red",t),l("Get image...","red",t);let s="";for(let t=0;t<10;t++)if(t>0&&await a(1e3),s=await P(e),s&&k!==s){k=s;break}if(!s)return;l("Create task...","red",t);const r=JSON.stringify({clientKey:y,task:{type:"GeetestGobangWebTask",imageBase64:s}}),c=await o(r);let n="";if(!c||c.error||c.message){if(n=c.error?c.errorDescription:c.message?c.message:"No response createTask",l(n,"red",t),p){document.querySelector('[class*="geetest_box"][style="display: block;"] button[class*="geetest_refresh"]').click();continue}return}l("Get result...","red",t);const u=await i(y,c.taskId,30);if(!u||u.errorDescription){if(l(u?u.errorDescription:"No result from API","red",t),p){document.querySelector('[class*="geetest_box"][style="display: block;"] button[class*="geetest_refresh"]').click();continue}return}const g=document.querySelectorAll(".geetest_subitem .geetest_itemimg");l("Solving...","red",t),await M(g,u.swap_positions),await a(3500);if(document.querySelector('[class*="geetest_box"][style="display: block;"]')){if(l("Solve failed","red",t),p){document.querySelector('[class*="geetest_box"][style="display: block;"] button[class*="geetest_refresh"]').click();continue}return}return}}async function S(){for(;;){await a(1200);let t=null;for(let e=0;e<10&&(e>0&&await a(1e3),t=document.querySelector('[class*="geetest_box"][style="display: block;"] [class*="geetest_slide"] [class*="geetest_window"]'),null==t);e++);if(!t)return;let s=document.querySelector('[class*="geetest_box"][style*="display: block;"] [class*="geetest_header"] [class*="geetest_title"]');l("Captcha slide","red",s),l("Get image...","red",s);let r="";for(let e=0;e<10;e++)if(e>0&&await a(1e3),r=await D(t),r&&k!==r){k=r;break}if(!r)return;l("Create task...","red",s);const c=JSON.stringify({clientKey:y,task:{type:"GeetestSliderWebTask",imageBase64:r}}),n=await o(c);let u="";if(!n||n.error||n.message){if(u=n.error?n.errorDescription:n.message?n.message:"No response createTask",l(u,"red",s),p){document.querySelector('[class*="geetest_box"][style="display: block;"] button[class*="geetest_refresh"]').click();continue}return}l("Get result...","red",s);const g=await i(y,n.taskId,30);if(!g||g.errorDescription){if(l(g?g.errorDescription:"No result from API","red",s),p){document.querySelector('[class*="geetest_box"][style="display: block;"] button[class*="geetest_refresh"]').click();continue}return}let d=parseInt(g.end.x,10);var e=document.querySelector('[class*="geetest_box"][style="display: block;"] [class*="geetest_slide"] [class*="geetest_window"]>[class*="geetest_slice"]');l("Captcha slide solving...","red",s),await T(e,d),await a(3500);if(document.querySelector('[class*="geetest_box"][style="display: block;"]')){if(l("Solve failed","red",s),p)continue;return}return}}async function x(){for(;;){await a(700);let _=null;for(let e=0;e<10&&(e>0&&await a(1200),_=document.querySelector('[class*="geetest_box"][style="display: block;"] [class*="geetest_click"]>[class*="geetest_window"] [class*="geetest_bg"]'),null==_);e++);if(!_)return;let m=document.querySelector('[class*="geetest_box"][style*="display: block;"] [class*="geetest_header"] [class*="geetest_title"]');l("Captcha Click","red",m);let w="";for(let e=0;e<10;e++){e>0&&await a(1e3);const t=getComputedStyle(_).backgroundImage;if(t&&"none"!==t&&(w=await u(_),w&&k!==w)){k=w;break}}if(!w)return;w=await g(w,_);let h=[];for(let e=0;e<5;e++){const e=document.querySelectorAll("[class*='geetest_ques_tips geetest_ques_back'] img");h=[];for(let t=0;t<e.length;t++)try{const s=await n(e[t]);h.push(s)}catch(e){h.push(null)}if(3===h.length&&h.every((e=>null!==e)))break;await a(1e3)}if(3!==h.length||h.some((e=>!e))){if(p){document.querySelector('[class*="geetest_box"][style="display: block;"] button[class*="geetest_refresh"]').click();continue}return}l("Create task...","red",m);const S={type:"GeetestIconWebTask",imageBase64:w,anchorImageBase64s:[h[0],h[1],h[2]]},x=JSON.stringify({clientKey:y,task:S}),q=await o(x);let C="";if(!q||q.error||q.message){if(C=q.error?q.errorDescription:q.message?q.message:"No response createTask",l(C,"red",m),p){document.querySelector('[class*="geetest_box"][style="display: block;"] button[class*="geetest_refresh"]').click();continue}return}l("Get result...","red",m);const v=await i(y,q.taskId,30);if(!v||v.errorDescription){if(l(v?v.errorDescription:"No result from API","red",m),p){document.querySelector('[class*="geetest_box"][style="display: block;"] button[class*="geetest_refresh"]').click();continue}return}l("Clicking...","red",m);for(const l of v.points){const c=parseInt(l.x,10),o=parseInt(l.y,10);t=c,s=o,r=void 0,d=void 0,f=void 0,b=void 0,r=(e=_).getBoundingClientRect(),d=r.left+t,f=r.top+s,b=new MouseEvent("click",{bubbles:!0,clientX:d,clientY:f}),e.dispatchEvent(b),await a(500)}c(document.querySelector('[class*="geetest_click"] [class*="geetest_submit"]')),await a(3500);if(document.querySelector('[class*="geetest_box"][style="display: block;"]')){if(l("Solve failed","red",m),p)continue;return}return}var e,t,s,r,d,f,b}async function q(){for(;;){await a(1e3);let e=null;for(let t=0;t<10&&(t>0&&await a(1e3),e=document.querySelector('[class*="geetest_box"][style="display: block;"] [class*="geetest_container"] [class*="geetest_match"]'),null==e);t++);if(!e)return;let t=document.querySelector('[class*="geetest_box"][style*="display: block;"] [class*="geetest_header"] [class*="geetest_title"]');l("Captcha IconCrush","red",t),l("Get image...","red",t);let s="";for(let t=0;t<10;t++){if(s=await N(e),s&&k!==s){k=s;break}await a(1e3)}if(!s)return;l("Create task...","red",t);const r=JSON.stringify({clientKey:y,task:{type:"GeetestIconCrushWebTask",imageBase64:s}}),c=await o(r);let n="";if(!c||c.error||c.message){if(n=c.error?c.errorDescription:c.message?c.message:"No response createTask",l(n,"red",t),p){document.querySelector('[class*="geetest_box"][style="display: block;"] button[class*="geetest_refresh"]').click();continue}return}l("Get result...","red",t);const u=await i(y,c.taskId,30);if(!u||u.errorDescription){if(l(u?u.errorDescription:"No result from API","red",t),p){document.querySelector('[class*="geetest_box"][style="display: block;"] button[class*="geetest_refresh"]').click();continue}return}l("Solving...","red",t);const g=document.querySelectorAll(".geetest_backimg");await O(g,u.swap_positions),await a(3500);if(document.querySelector('[class*="geetest_box"][style="display: block;"]')){if(l("Solve failed","red",t),p){document.querySelector('[class*="geetest_box"][style="display: block;"] button[class*="geetest_refresh"]').click();continue}return}return}}async function C(){for(;;){await a(700);const e=document.querySelector('[class*="geetest_box"][style*="display: block;"]');if(!e){await a(1e3);continue}let t=null;for(let s=0;s<20&&(s>0&&await a(500),t=e.querySelector('[class*="geetest_box"][style*="display: block;"] [class*="geetest_nine"] [class*="geetest_window"] [class*="geetest_item"] [class*="geetest_item_img"]'),!t);s++);if(!t)return;const s=e.querySelector('[class*="geetest_box"][style*="display: block;"] [class*="geetest_header"] [class*="geetest_title"]');l("Captcha Image","red",s);let r="";for(let e=0;e<10;e++){e>0&&await a(1e3);const s=getComputedStyle(t).backgroundImage;if(s&&"none"!==s&&(r=await u(t),r&&k!==r)){k=r;break}}if(!r)return;let g=null;for(let t=0;t<5;t++){const t=e.querySelector('[class*="geetest_box"][style*="display: block;"] [class*="geetest_ques_tips"][class*="geetest_ques_back"] img');if(t)try{g=await n(t)}catch(e){g=null}if(g)break;await a(1e3)}if(!g){if(p){e.querySelector('[class*="geetest_box"][style*="display: block;"] button[class*="geetest_refresh"]')?.click(),await a(1e3);continue}return}const d=e.querySelector('[class*="geetest_box"][style*="display: block;"] [class*="geetest_header"] .geetest_text_tips'),f=d?d.textContent.replace(/\s+/g," ").trim():null;l("Create task...","red",s);const b={type:"GeetestSelectObjectTask",imageBase64:r,question:f,anchor:g},_=JSON.stringify({clientKey:y,task:b}),m=await o(_);let w="";if(!m||m.error||m.message){if(w=m.error?m.errorDescription:m.message?m.message:"No response createTask",l(w,"red",s),p){e.querySelector('[class*="geetest_box"][style*="display: block;"] button[class*="geetest_refresh"]')?.click(),await a(1e3);continue}return}l("Get result...","red",s);const h=await i(y,m.taskId,30);if(!h||h.errorDescription){if(l(h?h.errorDescription:"No result from API","red",s),p){e.querySelector('[class*="geetest_box"][style*="display: block;"] button[class*="geetest_refresh"]')?.click(),await a(1e3);continue}return}l("Clicking...","red",s);const S=document.querySelectorAll('[class*="geetest_box"][style*="display: block;"] [class*="geetest_nine"] [class*="geetest_window"] .geetest_item .geetest_item_ghost'),x=h.objects;for(let e=0;e<x.length;e++)e>0&&await a(50+Math.floor(51*Math.random())),c(S[x[e]]);await a(3500);if(document.querySelector('[class*="geetest_box"][style*="display: block;"]')){if(l("Solve failed","red",s),e.querySelector('[class*="geetest_box"][style*="display: block;"] button[class*="geetest_refresh"]')?.click(),p){await a(500);continue}return}return}}async function v(){for(;;){await a(700);const e=document.querySelector('[class*="geetest_box"][style*="display: block;"]');if(!e){await a(1e3);continue}let t=null;for(let s=0;s<20&&(s>0&&await a(500),t=e.querySelector('[class*="geetest_box"][style*="display: block;"] [class*="geetest_nine"] [class*="geetest_item"]'),!t);s++);if(!t)return;const s=e.querySelector('[class*="geetest_box"][style*="display: block;"] [class*="geetest_box_header"]');l("Captcha Image","red",s);let r="";for(let e=0;e<10;e++){e>0&&await a(1e3);const s=getComputedStyle(t).backgroundImage;if(s&&"none"!==s&&(r=await u(t),r&&k!==r)){k=r;break}}if(!r)return;let g=null;for(let t=0;t<5;t++){const t=e.querySelector('[class*="geetest_box"][style*="display: block;"] [class*="geetest_box_header"] [class*="geetest_box_answer"] img');if(t)try{g=await n(t)}catch(e){g=null}if(g)break;await a(1e3)}if(!g){if(p){e.querySelector('[class*="geetest_box"][style*="display: block;"] [class="geetest_refresh"]')?.click(),await a(1e3);continue}return}const d=e.querySelector('[class*="geetest_box"][style*="display: block;"] [class*="geetest_box_header"] .geetest_box_title'),f=d?d.textContent.replace(/\s+/g," ").trim():null;l("Create task...","red",s);const b={type:"GeetestSelectObjectTask",imageBase64:r,question:f,anchor:g},_=JSON.stringify({clientKey:y,task:b}),m=await o(_);let w="";if(!m||m.error||m.message){if(w=m.error?m.errorDescription:m.message?m.message:"No response createTask",l(w,"red",s),p){e.querySelector('[class*="geetest_box"][style*="display: block;"] [class="geetest_refresh"]')?.click(),await a(1e3);continue}return}l("Get result...","red",s);const h=await i(y,m.taskId,30);if(!h||h.errorDescription){if(l(h?h.errorDescription:"No result from API","red",s),p){e.querySelector('[class*="geetest_box"][style*="display: block;"] [class="geetest_refresh"]')?.click(),await a(1e3);continue}return}l("Clicking...","red",s);const S=document.querySelectorAll('[class*="geetest_box"][style*="display: block;"] [class*="geetest_nine"] .geetest_item'),x=h.objects;for(let e=0;e<x.length;e++)e>0&&await a(50+Math.floor(51*Math.random())),c(S[x[e]]);await a(3500);if(document.querySelector('[class*="geetest_box"][style*="display: block;"]')){if(l("Solve failed","red",s),e.querySelector('[class*="geetest_box"][style*="display: block;"] [class="geetest_refresh"]')?.click(),p){await a(500);continue}return}return}}async function E(){for(;;){await a(1200);let t=null;for(let e=0;e<20&&(e>0&&await a(500),t=document.querySelector('[class*="geetest_box"][style*="display: block;"] [class*="geetest_windows"]'),null==t);e++);if(!t)return;let s=document.querySelector('[class*="geetest_box"][style*="display: block;"] [class*="geetest_box_header"] [class*="geetest_box_title"]');l("Captcha slide","red",s),l("Get image...","red",s);let r="";for(let e=0;e<20;e++)if(e>0&&await a(500),r=await D(t),r&&k!==r){k=r;break}if(!r)return;l("Create task...","red",s);const c=JSON.stringify({clientKey:y,task:{type:"GeetestSliderWebTask",imageBase64:r}}),n=await o(c);let u="";if(!n||n.error||n.message){if(u=n.error?n.errorDescription:n.message?n.message:"No response createTask",l(u,"red",s),p){document.querySelector('[class*="geetest_box"][style*="display: block;"] [class="geetest_refresh"]').click();continue}return}l("Get result...","red",s);const g=await i(y,n.taskId,30);if(!g||g.errorDescription){if(l(g?g.errorDescription:"No result from API","red",s),p){document.querySelector('[class*="geetest_box"][style*="display: block;"] [class="geetest_refresh"]').click();continue}return}let d=parseInt(g.end.x,10);var e=document.querySelector('[class*="geetest_box"][style*="display: block;"] [class*="geetest_window"]>[class*="geetest_slice"]');l("Captcha slide solving...","red",s),await T(e,d),await a(3500);if(document.querySelector('[class*="geetest_box"][style*="display: block;"]')){if(l("Solve failed","red",s),p)continue;return}return}}async function I(){for(;;){await a(1e3);let e=null;for(let t=0;t<10&&(t>0&&await a(1e3),e=document.querySelector('[class*="geetest_box"][style*="display: block;"] [class*="geetest_captcha_wrap"] [class*="geetest_line_"]'),null==e);t++);if(!e)return;let t=document.querySelector('[class*="geetest_box"][style*="display: block;"] [class*="geetest_box_header"] [class*="geetest_box_title"]');l("Captcha IconCrush","red",t),l("Get image...","red",t);let s="";for(let t=0;t<10;t++){if(s=await N(e),s&&k!==s){k=s;break}await a(1e3)}if(!s)return;l("Create task...","red",t);const r=JSON.stringify({clientKey:y,task:{type:"GeetestIconCrushWebTask",imageBase64:s}}),c=await o(r);let n="";if(!c||c.error||c.message){if(n=c.error?c.errorDescription:c.message?c.message:"No response createTask",l(n,"red",t),p){document.querySelector('[class*="geetest_box"][style*="display: block;"] [class="geetest_refresh"]').click();continue}return}l("Get result...","red",t);const u=await i(y,c.taskId,30);if(!u||u.errorDescription){if(l(u?u.errorDescription:"No result from API","red",t),p){document.querySelector('[class*="geetest_box"][style*="display: block;"] [class="geetest_refresh"]').click();continue}return}l("Solving...","red",t);const g=document.querySelectorAll('[class*="geetest_box"][style*="display: block;"] [class*="geetest_captcha_wrap"] [class*="geetest_line_"] .geetest_item');await O(g,u.swap_positions),await a(3500);if(document.querySelector('[class*="geetest_box"][style*="display: block;"]')){if(l("Solve failed","red",t),p){document.querySelector('[class*="geetest_box"][style*="display: block;"] [class="geetest_refresh"]').click();continue}return}return}}function A(e){return!!document.querySelector(e)}async function T(e,t){return new Promise((s=>{if(!e)return s();e.parentElement;const l=t,r=new DataTransfer,c=b;function o(t){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};e.dispatchEvent(new MouseEvent(t,{bubbles:!0,cancelable:!0,...s})),e.dispatchEvent(new PointerEvent(t,{bubbles:!0,cancelable:!0,...s,pointerType:"mouse",isPrimary:!0}))}(async()=>{o("mouseenter"),o("mouseover"),await a(c),o("pointerdown",{clientX:0,clientY:0}),o("mousedown",{clientX:0,clientY:0}),e.dispatchEvent(new DragEvent("dragstart",{bubbles:!0,cancelable:!0,dataTransfer:r}));let i=0,n=0;for(;i+10<t;){const e=i/t;let s;s=e<.3?2*Math.random()+1:e<.7?6*Math.random()+2:2*Math.random()+.5,i+=s,n+=8*(Math.random()-.5);const r=Math.min(i,l),u=n;o("mousemove",{clientX:r,clientY:u}),o("pointermove",{clientX:r,clientY:u}),await a(c)}i=t;const u=n;o("mousemove",{clientX:i,clientY:u}),o("pointermove",{clientX:i,clientY:u}),await a(c),o("pointerup",{clientX:i,clientY:u}),o("mouseup",{clientX:i,clientY:u}),e.dispatchEvent(new DragEvent("dragend",{bubbles:!0,cancelable:!0,dataTransfer:r})),s()})()}))}async function D(e){return new Promise((async(t,s)=>{try{if(!(e instanceof HTMLElement))return t("");const a=e.getBoundingClientRect(),l=Math.round(a.width),r=Math.round(a.height);if(l<=0||r<=0)return t("");const c=document.createElement("canvas");c.width=l,c.height=r;const o=c.getContext("2d");async function i(e){return new Promise((t=>{chrome.runtime.sendMessage({type:"createImageBase64",data:{url:e}},(e=>{if(chrome.runtime.lastError)return t(null);if(!e)return t(null);const s=new Image;s.src="data:image/png;base64,"+e,s.onload=()=>t(s),s.onerror=()=>t(null)}))}))}function n(e){if(!e)return"";const t=getComputedStyle(e).backgroundImage.match(/url\(["']?(.*?)["']?\)/);return t?new URL(t[1],window.location.href).href:""}async function u(t){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:500;for(let l=0;l<s;l++){const s=e.querySelector(t);if(s){const e=n(s);if(e&&"none"!==e)return{el:s,url:e}}await new Promise((e=>setTimeout(e,a)))}return{el:null,url:""}}const{el:g,url:d}=await u(".geetest_bg")||await u('[class*="geetest_bg"]');if(!g||!d)return s(new Error("Không tìm thấy ảnh nền Geetest"));const y=await i(d);if(!y)return s(new Error("Không tải được ảnh nền"));o.drawImage(y,0,0,l,r);const f=e.querySelector(".geetest_slice")||e.querySelector('[class*="geetest_slice"]'),b=f?.querySelector(".geetest_slice_bg")||f?.querySelector('[class*="geetest_slice_bg"]')||f;if(f&&b){const p=n(b);if(p){const _=await i(p);if(_){const m=f.getBoundingClientRect(),w=e.getBoundingClientRect(),k=Math.round(m.left-w.left),h=Math.round(m.top-w.top),S=Math.round(m.width),x=Math.round(m.height);S>0&&x>0&&o.drawImage(_,k,h,S,x)}}}t(c.toDataURL("image/jpeg").split(",")[1]||"")}catch(q){s(q)}}))}async function P(e){if(!e)return;const t=getComputedStyle(e).backgroundColor||"#dce3ed",s=e.querySelectorAll(".geetest_item"),a=s.length,l=s[0]?.querySelectorAll(".geetest_itemimg").length||0;if(0===a||0===l)return;const r=s[0].querySelector(".geetest_itemimg").getBoundingClientRect(),c=r.width,o=r.height,i=document.createElement("canvas");i.width=c*l,i.height=o*a;const n=i.getContext("2d");n.fillStyle=t,n.fillRect(0,0,i.width,i.height);const u=[];s.forEach(((e,t)=>{e.querySelectorAll(".geetest_itemimg").forEach(((e,s)=>{const a=getComputedStyle(e).backgroundImage.match(/url\("(.+)"\)/);if(a){const e=a[1];u.push({type:"image",imgUrl:e,row:t,col:s})}else u.push({type:"empty",row:t,col:s})}))}));for(const e of u){const t=e.col*c,s=e.row*o,a=.8,l=c*a,r=o*a,i=t+(c-l)/2,u=s+(o-r)/2;if("image"===e.type)try{const t=await R(e.imgUrl);n.drawImage(t,i,u,l,r)}catch(e){}else n.fillStyle="rgba(200, 210, 220, 1)",n.beginPath(),n.arc(t+c/2,s+o/2,Math.min(c,o)*a*.5,0,2*Math.PI),n.fill()}return i.toDataURL("image/jpeg").split(",")[1]}async function N(e){if(!e)return;const t=getComputedStyle(e).backgroundColor||"#ffffff";let s=Array.from(e.querySelectorAll('[class*="geetest_img"]'));if(9!==s.length&&(s=Array.from(document.querySelectorAll(".geetest_item")),9!==s.length))return;const a=[];for(let e=0;e<3;e++)for(let t=0;t<3;t++)a.push(s[3*t+e]);const l=document.createElement("canvas");l.width=200,l.height=200;const r=l.getContext("2d");r.fillStyle=t,r.fillRect(0,0,l.width,l.height);const c=200/3,o=.9*c,i=3.333333333333332;for(let e=0;e<9;e++){const t=Math.floor(e/3),s=e%3,l=getComputedStyle(a[e]).backgroundImage.match(/url\("(.+)"\)/);if(!l)continue;const n=l[1];try{const e=await R(n),a=s*c,l=t*c;r.drawImage(e,a+i,l+i,o,o)}catch(e){}}return l.toDataURL("image/jpeg").split(",")[1]}async function M(e,t){for(const s of t){const t=s-1;e[t]&&(e[t].click(),await a(500))}}async function O(e,t){for(const s of t){const t=s-1,l=e[3*(t%3)+Math.floor(t/3)];l&&(l.click(),await a(500))}}function G(e){return new Promise(((t,s)=>{const a=new Image;a.crossOrigin="Anonymous",a.onload=()=>t(a),a.onerror=s,a.src=e}))}async function R(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e3;for(let l=1;l<=t;l++)try{return await G(e)}catch(e){if(l===t)throw e;await a(s)}}(async()=>{await m();new MutationObserver((async(e,t)=>{await async function(e){if(await m(),d&&_&&y&&"YOUR_CLIEN_KEY"!==y)for(const t of e)if("childList"===t.type){const e=document.querySelector('[class*="geetest_container"]'),t=document.querySelector('[class*="geetest_captcha_wrap"]');if(!e&&!t||w)continue;if(!y)return;w=!0;try{if(await a(1e3),!await r(['[class*="geetest_box"][style="display: block;"] [class*="geetest_container"] [class*="geetest_slide"]','[class*="geetest_box"][style="display: block;"] [class*="geetest_container"] [class*="geetest_winlinze"]','[class*="geetest_box"][style="display: block;"] [class*="geetest_container"] [class*="geetest_click"]','[class*="geetest_box"][style="display: block;"] [class*="geetest_container"] [class*="geetest_match"]','[class*="geetest_box"][style="display: block;"] [class*="geetest_container"] [class*="geetest_nine"]','[class*="geetest_box"][style*="display: block;"] [class*="geetest_captcha_wrap"] [class*="geetest_nine"]','[class*="geetest_box"][style*="display: block;"] [class*="geetest_captcha_wrap"] [class*="geetest_slice"]','[class*="geetest_box"][style*="display: block;"] [class*="geetest_captcha_wrap"] [class*="geetest_line_"]'],1e4))return;for(let e=0;e<20;e++){if(A('[class*="geetest_box"][style="display: block;"] [class*="geetest_container"] [class*="geetest_winlinze"]')){await h();break}if(A('[class*="geetest_box"][style="display: block;"] [class*="geetest_container"] [class*="geetest_slide"]')){await S();break}if(A('[class*="geetest_box"][style="display: block;"] [class*="geetest_container"] [class*="geetest_click"]')){await x();break}if(A('[class*="geetest_box"][style="display: block;"] [class*="geetest_container"] [class*="geetest_match"]')){await q();break}if(A('[class*="geetest_box"][style="display: block;"] [class*="geetest_container"] [class*="geetest_nine"]')){await C();break}if(A('[class*="geetest_box"][style*="display: block;"] [class*="geetest_captcha_wrap"] [class*="geetest_nine"]')){await v();break}if(A('[class*="geetest_box"][style*="display: block;"] [class*="geetest_captcha_wrap"] [class*="geetest_slice"]')){await E();break}if(A('[class*="geetest_box"][style*="display: block;"] [class*="geetest_captcha_wrap"] [class*="geetest_line_"]')){await I();break}await a(1e3)}}finally{w=!1}}}(e)})).observe(document.body,{childList:!0,subtree:!0});for(let e=0;e<60;e++){const e=document.querySelector('[class*="geetest_holder"] [class*="geetest_btn_click"]');if(document.querySelector('[class*="geetest_box"][style="display: block;"] [class*="geetest_container"]'))break;e&&c(e),await a(800)}})()})();